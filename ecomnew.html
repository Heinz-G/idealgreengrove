<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ideal Green Grove | Premium South African Cannabis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600&family=Oswald:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dark: { 
                            950: '#050505', 
                            900: '#0a0a0a', 
                            800: '#121212', 
                            700: '#1f1f1f' 
                        },
                        neon: { 
                            green: '#00ff9d', // Slightly more emerald/mint
                            dim: 'rgba(0, 255, 157, 0.1)',
                            accent: '#7000ff'
                        }
                    },
                    fontFamily: { 
                        sans: ['Montserrat', 'sans-serif'], 
                        header: ['Oswald', 'sans-serif'] 
                    },
                    backgroundImage: {
                        'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'glow': 'glow 4s ease-in-out infinite alternate',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        glow: {
                            '0%': { boxShadow: '0 0 5px rgba(0,255,157, 0.1)' },
                            '100%': { boxShadow: '0 0 20px rgba(0,255,157, 0.4)' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #050505;
            color: #e5e5e5;
        }

        /* Subtle Noise Overlay */
        .noise-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0.03;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48ZmlsdGVyIGlkPSJnoiPjxmZVR1cmJ1bGVuY2UgdHlwZT0iZnJhY3RhbE5vaXNlIiBiYXNlRnJlcXVlbmN5PSIwLjY1IiBudW1PY3RhdmVzPSIzIiBzdGl0Y2hUaWxlcz0ic3RpdGNoIi8+PC9maWx0ZXI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsdGVyPSJ1cmwoI2cpIiBvcGFjaXR5PSIwLjUiLz48L3N2Zz4=');
        }

        /* Premium Glassmorphism */
        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .glass-hover:hover {
            background: rgba(255, 255, 255, 0.07);
            border-color: rgba(0, 255, 157, 0.3);
            transform: translateY(-5px);
            box-shadow: 0 10px 40px -10px rgba(0,0,0,0.5);
        }

        .text-glow {
            text-shadow: 0 0 15px rgba(0, 255, 157, 0.3);
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #050505; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #00ff9d; }

        .hidden-page { display: none; opacity: 0; }
        .fade-in { animation: fadeIn 0.5s forwards; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="antialiased overflow-x-hidden relative">

    <div class="noise-bg"></div>
    <div class="fixed top-0 left-0 w-full h-[500px] bg-gradient-radial from-neon-dim to-transparent opacity-40 pointer-events-none z-0"></div>
    
    <nav class="fixed w-full z-50 transition-all duration-300 glass border-b border-white/5" id="navbar">
        <div class="container mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <a href="#" onclick="router('home')" class="text-2xl md:text-3xl font-header font-bold text-white tracking-[0.2em] relative group">
                    IDEAL<span class="text-neon-green">GREEN</span>
                </a>

                <div class="hidden md:flex items-center space-x-8 font-header text-sm uppercase tracking-widest font-medium">
                    <a href="#" onclick="router('shop', 'flower')" class="hover:text-neon-green transition-colors duration-300">Flower</a>
                    <a href="#" onclick="router('shop', 'edibles')" class="hover:text-neon-green transition-colors duration-300">Edibles</a>
                    <a href="#" onclick="router('shop', 'vapes')" class="hover:text-neon-green transition-colors duration-300">Vapes</a>
                    <a href="#" onclick="router('shop', 'wellness')" class="hover:text-neon-green transition-colors duration-300">Wellness</a>
                    <a href="#" onclick="router('home', 'offers')" class="text-neon-green border border-neon-green/30 px-4 py-2 rounded hover:bg-neon-green hover:text-dark-950 transition-all">
                        Offers
                    </a>
                </div>

                <div class="flex items-center space-x-6">
                    <button class="hover:text-neon-green transition"><i class="fas fa-search"></i></button>
                    <button onclick="toggleCart()" class="relative hover:text-neon-green transition">
                        <i class="fas fa-shopping-bag"></i>
                        <span id="cart-count" class="absolute -top-2 -right-2 bg-neon-green text-dark-950 text-[10px] font-bold h-4 w-4 flex items-center justify-center rounded-full opacity-0 transition-opacity">0</span>
                    </button>
                    <button class="md:hidden text-xl"><i class="fas fa-bars"></i></button>
                </div>
            </div>
        </div>
    </nav>

    <main id="app" class="relative z-10 min-h-screen pt-20">
        </main>

    <footer class="bg-dark-900 border-t border-white/5 pt-20 pb-10 relative z-10 mt-auto">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-12 mb-12">
                <div class="col-span-1 md:col-span-2">
                    <h4 class="font-header text-2xl font-bold mb-4 tracking-widest">IDEAL<span class="text-neon-green">GREEN</span>GROVE</h4>
                    <p class="text-gray-500 max-w-sm leading-relaxed text-sm">
                        Redefining the standard. We provide premium, lab-tested cannabis products delivered with discretion and speed across South Africa.
                    </p>
                </div>
                <div>
                    <h4 class="font-header text-white font-bold mb-6 tracking-widest text-sm">Shop</h4>
                    <ul class="space-y-3 text-gray-500 text-sm">
                        <li><a href="#" onclick="router('shop')" class="hover:text-neon-green transition">All Products</a></li>
                        <li><a href="#" onclick="router('shop', 'flower')" class="hover:text-neon-green transition">Flower</a></li>
                        <li><a href="#" onclick="router('shop', 'vapes')" class="hover:text-neon-green transition">Concentrates</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-header text-white font-bold mb-6 tracking-widest text-sm">Legal</h4>
                    <ul class="space-y-3 text-gray-500 text-sm">
                        <li><a href="#" class="hover:text-neon-green transition">Privacy Policy</a></li>
                        <li><a href="#" class="hover:text-neon-green transition">Terms of Service</a></li>
                        <li><a href="#" class="hover:text-neon-green transition">Wholesale</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-white/5 pt-8 flex flex-col md:flex-row justify-between items-center text-xs text-gray-600">
                <p>&copy; 2026 Ideal Green Grove. All rights reserved.</p>
                <div class="flex items-center mt-4 md:mt-0">
                    <i class="fas fa-ban text-red-500 mr-2"></i> Not for sale to persons under 18.
                </div>
            </div>
        </div>
    </footer>

    <div id="cart-sidebar" class="fixed inset-y-0 right-0 w-full md:w-96 bg-dark-900 z-[60] transform translate-x-full transition-transform duration-300 border-l border-white/10 shadow-2xl flex flex-col">
        <div class="p-6 border-b border-white/5 flex justify-between items-center">
            <h2 class="font-header text-xl tracking-widest">YOUR STASH</h2>
            <button onclick="toggleCart()" class="text-gray-400 hover:text-white"><i class="fas fa-times text-xl"></i></button>
        </div>
        <div class="flex-1 p-6 flex items-center justify-center text-gray-500 flex-col" id="cart-items">
            <i class="fas fa-leaf text-4xl mb-4 opacity-20"></i>
            <p>Your stash is empty.</p>
            <button onclick="toggleCart(); router('shop')" class="mt-4 text-neon-green text-sm font-bold border-b border-neon-green pb-1">START BROWSING</button>
        </div>
        <div class="p-6 border-t border-white/5 bg-dark-800">
            <div class="flex justify-between mb-4 font-header text-lg">
                <span>Total</span>
                <span>R0.00</span>
            </div>
            <button class="w-full bg-neon-green text-dark-950 font-header font-bold py-4 rounded hover:bg-white transition tracking-widest">CHECKOUT</button>
        </div>
    </div>
    <div id="cart-backdrop" onclick="toggleCart()" class="fixed inset-0 bg-black/80 z-[55] hidden backdrop-blur-sm"></div>

    <script>
        // --- DATA STORE ---
        const offers = [
            {
                id: 1,
                tier: "Tier 1",
                persona: "The Skeptic",
                name: "The Curious Starter",
                tagline: "Try our quality without a major commitment. Perfect for first-timers.",
                price: 299,
                value: 450,
                items: [
                    "1x Premium Pre-Roll (Hybrid)",
                    "2-Pack 'Dope Donuts' Tester",
                    "Free Shipping Voucher for next order"
                ],
                cta: "Start Your Journey",
                color: "gray-500",
                quiz: "curious"
            },
            {
                id: 2,
                tier: "Tier 2",
                persona: "The Stressed Pro",
                name: "The Deep Sleep System",
                tagline: "Switch off your brain instantly. Get 8 hours of uninterrupted rest.",
                price: 799,
                value: 1100,
                items: [
                    "High-Dose CBD Sleep Gummies (30ct)",
                    "Heavy Indica Vape Cartridge",
                    "510 Thread Battery included"
                ],
                cta: "Get Better Sleep",
                color: "neon-green",
                featured: true,
                quiz: "sleep"
            },
            {
                id: 3,
                tier: "Tier 3",
                persona: "The Weekender",
                name: "The Friday Social Stack",
                tagline: "The perfect uplifting mix for social gatherings without the alcohol hangover.",
                price: 599,
                value: 850,
                items: [
                    "3g Sativa Indoor Flower",
                    "Pack of 5 Social Pre-Rolls",
                    "Smell-proof travel slider tin"
                ],
                cta: "Elevate Your Weekend",
                color: "gray-500",
                quiz: "social"
            },
            {
                id: 4,
                tier: "Tier 4",
                persona: "The Enthusiast",
                name: "The Top-Shelf Experience",
                tagline: "For those who appreciate complex terpene profiles and premium hardware.",
                price: 1800,
                value: 2500,
                items: [
                    "5g 'Reserve' Indoor (Import Genetics)",
                    "Ceramic Core Sleek Vape Pen",
                    "Artisan Chocolate Edibles Box"
                ],
                cta: "Upgrade Your Stash",
                color: "blue-400",
                quiz: "connoisseur"
            },
            {
                id: 5,
                tier: "Tier 5",
                persona: "The Regular",
                name: "The Monthly Re-Up",
                tagline: "Set and forget. Enough premium stock to last the heavy user a full month.",
                price: 3500,
                value: 5000,
                items: [
                    "28g (Ounce) Greenhouse Mix",
                    "3x Full Gram Vape Cartridges",
                    "Large format Edibles Jar"
                ],
                cta: "Stock Up Now",
                color: "purple-500",
                quiz: "regular"
            },
            {
                id: 6,
                tier: "Tier 6",
                persona: "The Empire Builder",
                name: "The Dispensary Launchpad",
                tagline: "Business in a box. We provide stock, branding, and mentorship to start your own shop.",
                price: 100000,
                value: 150000,
                items: [
                    "R150k Retail Value Inventory",
                    "White-label packaging options",
                    "3 Months 1-on-1 wholesale mentorship"
                ],
                cta: "Apply For Partnership",
                color: "purple-500",
                gradient: true,
                quiz: "business"
            }
        ];

        const products = [
            {
                id: 101,
                name: "Purple Haze Indoor",
                category: "flower",
                price: 150,
                image: "https://images.unsplash.com/photo-1603909223429-69bb7101f420?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                desc: "A legendary sativa known for its high energy cerebral stimulation. Sweet and earthy berry flavors."
            },
            {
                id: 102,
                name: "O.G. Kush Reserve",
                category: "flower",
                price: 180,
                image: "https://images.unsplash.com/photo-1556928045-16f7f50be0f3?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                desc: "The genetic backbone of West Coast cannabis varieties. Complex aroma with notes of fuel, skunk, and spice."
            },
            {
                id: 103,
                name: "Sleep Well Gummies",
                category: "edibles",
                price: 250,
                image: "https://images.unsplash.com/photo-1623594225330-580766a5e171?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                desc: "High dose CBD + CBN gummies designed to knock you out gently. Blueberry flavor."
            },
            {
                id: 104,
                name: "Ceramic Vape Cart",
                category: "vapes",
                price: 600,
                image: "https://images.unsplash.com/photo-1563823267-338b58482434?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                desc: "90% THC Distillate with live resin terpenes. No fillers, no Vitamin E acetate."
            },
            {
                id: 105,
                name: "CBD Recovery Oil",
                category: "wellness",
                price: 450,
                image: "https://images.unsplash.com/photo-1616258416032-474026607d72?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                desc: "Full spectrum oil for post-workout recovery and inflammation reduction."
            },
            {
                id: 106,
                name: "Space Brownies",
                category: "edibles",
                price: 120,
                image: "https://images.unsplash.com/photo-1576618148400-f54bed99fcfd?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                desc: "Artisan Belgian chocolate brownies. 50mg THC per serving. Handle with care."
            }
        ];

        // --- VIEWS ---

        const views = {
            home: () => `
                <section class="relative h-[85vh] flex items-center overflow-hidden">
                    <img src="https://images.unsplash.com/photo-1605309605703-e69248e30b35?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80" class="absolute inset-0 w-full h-full object-cover opacity-40 animate-pulse-slow scale-105">
                    <div class="absolute inset-0 bg-gradient-to-t from-dark-950 via-dark-950/60 to-transparent"></div>
                    
                    <div class="container mx-auto px-6 relative z-10 fade-in">
                        <span class="text-neon-green tracking-[0.3em] text-xs font-bold uppercase mb-4 block">Est. 2024 â€¢ Cape Town</span>
                        <h1 class="text-6xl md:text-8xl font-header font-bold text-white leading-none mb-6">
                            NATURE.<br>
                            <span class="text-transparent bg-clip-text bg-gradient-to-r from-neon-green to-blue-500">REFINED.</span>
                        </h1>
                        <p class="text-xl text-gray-400 max-w-xl mb-10 font-light">
                            Experience the intersection of botany and luxury. The finest indoor genetics, curated for the modern connoisseur.
                        </p>
                        <div class="flex space-x-4">
                            <button onclick="router('shop')" class="bg-neon-green text-dark-950 px-8 py-4 font-header font-bold rounded hover:bg-white transition tracking-widest">
                                SHOP COLLECTION
                            </button>
                            <button onclick="document.getElementById('offers').scrollIntoView({behavior: 'smooth'})" class="border border-white/20 text-white px-8 py-4 font-header font-bold rounded hover:bg-white/10 transition tracking-widest backdrop-blur-sm">
                                VIEW OFFERS
                            </button>
                        </div>
                    </div>
                </section>

                <section class="py-10 border-y border-white/5 bg-dark-900/50 backdrop-blur-sm">
                    <div class="container mx-auto px-6 flex flex-wrap justify-between gap-6 text-xs text-gray-400 font-bold uppercase tracking-widest">
                        <div class="flex items-center"><i class="fas fa-truck-fast text-neon-green mr-3 text-lg"></i> Nationwide Delivery</div>
                        <div class="flex items-center"><i class="fas fa-shield-halved text-neon-green mr-3 text-lg"></i> 100% Discrete</div>
                        <div class="flex items-center"><i class="fas fa-award text-neon-green mr-3 text-lg"></i> Top Shelf Only</div>
                    </div>
                </section>

                <section id="offers" class="py-24 container mx-auto px-6">
                    <div class="text-center mb-16">
                        <h2 class="text-4xl md:text-5xl font-header font-bold mb-4">FIND YOUR PERFECT OUTCOME</h2>
                        <p class="text-gray-400 max-w-xl mx-auto">Don't just buy products. Buy a result. Answer one question and we'll match you with the perfect bundle.</p>
                        <div class="w-24 h-1 bg-neon-green mx-auto mt-6"></div>
                    </div>

                    <!-- Quiz Container -->
                    <div id="offer-quiz" class="max-w-4xl mx-auto">
                        <p class="text-center text-neon-green font-header text-lg mb-8 tracking-widest">WHICH DESCRIBES YOU BEST?</p>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="quiz-options">
                            <button onclick="selectQuizOption('curious')" class="quiz-option glass p-6 rounded-xl text-left hover:bg-white/10 hover:border-neon-green/50 border border-transparent transition-all duration-300 group">
                                <div class="text-3xl mb-3">ðŸŒ±</div>
                                <h4 class="font-header text-lg text-white group-hover:text-neon-green transition">I'm Curious</h4>
                                <p class="text-gray-500 text-sm mt-1">Never tried premium. Want to test the waters.</p>
                            </button>

                            <button onclick="selectQuizOption('sleep')" class="quiz-option glass p-6 rounded-xl text-left hover:bg-white/10 hover:border-neon-green/50 border border-transparent transition-all duration-300 group">
                                <div class="text-3xl mb-3">ðŸ˜´</div>
                                <h4 class="font-header text-lg text-white group-hover:text-neon-green transition">I Need Better Sleep</h4>
                                <p class="text-gray-500 text-sm mt-1">Brain won't switch off. Need serious rest.</p>
                            </button>

                            <button onclick="selectQuizOption('social')" class="quiz-option glass p-6 rounded-xl text-left hover:bg-white/10 hover:border-neon-green/50 border border-transparent transition-all duration-300 group">
                                <div class="text-3xl mb-3">ðŸŽ‰</div>
                                <h4 class="font-header text-lg text-white group-hover:text-neon-green transition">I'm a Social Smoker</h4>
                                <p class="text-gray-500 text-sm mt-1">Weekends, gatherings, good vibes only.</p>
                            </button>

                            <button onclick="selectQuizOption('connoisseur')" class="quiz-option glass p-6 rounded-xl text-left hover:bg-white/10 hover:border-neon-green/50 border border-transparent transition-all duration-300 group">
                                <div class="text-3xl mb-3">ðŸ‘‘</div>
                                <h4 class="font-header text-lg text-white group-hover:text-neon-green transition">I Want the Best</h4>
                                <p class="text-gray-500 text-sm mt-1">Top-shelf genetics, premium hardware.</p>
                            </button>

                            <button onclick="selectQuizOption('regular')" class="quiz-option glass p-6 rounded-xl text-left hover:bg-white/10 hover:border-neon-green/50 border border-transparent transition-all duration-300 group">
                                <div class="text-3xl mb-3">ðŸ“¦</div>
                                <h4 class="font-header text-lg text-white group-hover:text-neon-green transition">I Need Monthly Supply</h4>
                                <p class="text-gray-500 text-sm mt-1">Daily user. Don't want to reorder constantly.</p>
                            </button>

                            <button onclick="selectQuizOption('business')" class="quiz-option glass p-6 rounded-xl text-left hover:bg-white/10 hover:border-neon-green/50 border border-transparent transition-all duration-300 group">
                                <div class="text-3xl mb-3">ðŸš€</div>
                                <h4 class="font-header text-lg text-white group-hover:text-neon-green transition">I Want to Start a Business</h4>
                                <p class="text-gray-500 text-sm mt-1">Ready to build my own cannabis empire.</p>
                            </button>
                        </div>
                    </div>

                    <!-- Result Container (Hidden by default) -->
                    <div id="offer-result" class="hidden max-w-2xl mx-auto">
                        <div id="offer-card" class="glass p-10 rounded-2xl border-t-4 border-neon-green relative overflow-hidden">
                            <div class="absolute top-0 right-0 w-64 h-64 bg-neon-green/5 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"></div>

                            <div class="relative z-10">
                                <div class="flex items-center justify-between mb-6">
                                    <span id="result-tier" class="text-neon-green text-sm font-bold uppercase tracking-widest"></span>
                                    <button onclick="resetQuiz()" class="text-gray-500 hover:text-white text-sm flex items-center gap-2 transition">
                                        <i class="fas fa-arrow-left"></i> Choose Again
                                    </button>
                                </div>

                                <h3 id="result-name" class="font-header text-4xl text-white mb-3"></h3>
                                <p id="result-tagline" class="text-gray-400 mb-8"></p>

                                <div class="bg-dark-800/50 rounded-xl p-6 mb-8">
                                    <p class="text-xs text-gray-500 uppercase tracking-widest mb-4">What's Included:</p>
                                    <ul id="result-items" class="space-y-3 text-gray-300"></ul>
                                </div>

                                <div class="flex flex-col sm:flex-row items-center justify-between gap-6">
                                    <div>
                                        <p class="text-gray-500 text-sm"><span class="line-through text-red-400" id="result-value"></span></p>
                                        <p class="text-4xl font-header font-bold text-neon-green" id="result-price"></p>
                                    </div>
                                    <button id="result-cta" onclick="addOfferToCart()" class="bg-neon-green text-dark-950 px-8 py-4 font-header font-bold rounded hover:bg-white transition uppercase tracking-widest w-full sm:w-auto text-center"></button>
                                </div>
                            </div>
                        </div>

                        <!-- Show All Link -->
                        <div class="text-center mt-8">
                            <button onclick="showAllOffers()" class="text-gray-500 hover:text-neon-green transition text-sm font-bold uppercase tracking-widest">
                                Or browse all 6 offers <i class="fas fa-chevron-down ml-2"></i>
                            </button>
                        </div>
                    </div>

                    <!-- All Offers Grid (Hidden by default) -->
                    <div id="all-offers" class="hidden mt-16">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="all-offers-grid"></div>
                    </div>
                </section>
            `,

            shop: (category = null) => {
                const filtered = category 
                    ? products.filter(p => p.category === category) 
                    : products;
                
                return `
                <div class="container mx-auto px-6 py-12 fade-in">
                    <div class="flex flex-col md:flex-row justify-between items-end mb-12 border-b border-white/10 pb-6">
                        <div>
                            <h1 class="text-4xl md:text-5xl font-header font-bold uppercase mb-2">The Vault</h1>
                            <p class="text-gray-400">Viewing: <span class="text-neon-green">${category ? category : 'All Products'}</span></p>
                        </div>
                        <div class="flex space-x-4 mt-4 md:mt-0 text-sm font-bold uppercase tracking-wider">
                            <button onclick="router('shop')" class="${!category ? 'text-neon-green' : 'text-gray-500 hover:text-white'}">All</button>
                            <button onclick="router('shop', 'flower')" class="${category === 'flower' ? 'text-neon-green' : 'text-gray-500 hover:text-white'}">Flower</button>
                            <button onclick="router('shop', 'vapes')" class="${category === 'vapes' ? 'text-neon-green' : 'text-gray-500 hover:text-white'}">Vapes</button>
                            <button onclick="router('shop', 'edibles')" class="${category === 'edibles' ? 'text-neon-green' : 'text-gray-500 hover:text-white'}">Edibles</button>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        ${filtered.map(p => `
                            <div class="glass-hover glass rounded-xl overflow-hidden group cursor-pointer transition-all duration-300" onclick="router('product', ${p.id})">
                                <div class="h-64 overflow-hidden relative">
                                    <img src="${p.image}" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                                    <div class="absolute inset-0 bg-black/20 group-hover:bg-transparent transition"></div>
                                </div>
                                <div class="p-6">
                                    <div class="flex justify-between items-start mb-2">
                                        <div>
                                            <p class="text-xs text-neon-green font-bold uppercase tracking-widest mb-1">${p.category}</p>
                                            <h3 class="text-xl font-header font-bold text-white group-hover:text-neon-green transition">${p.name}</h3>
                                        </div>
                                        <p class="text-xl font-header font-bold">R${p.price}</p>
                                    </div>
                                    <p class="text-gray-500 text-sm line-clamp-2">${p.desc}</p>
                                    <div class="mt-6 flex items-center text-xs font-bold uppercase tracking-widest text-white group-hover:text-neon-green transition">
                                        View Details <i class="fas fa-arrow-right ml-2"></i>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                `;
            },

            product: (id) => {
                const product = products.find(p => p.id === parseInt(id));
                if (!product) return router('shop');

                return `
                <div class="container mx-auto px-6 py-12 fade-in min-h-[80vh] flex items-center">
                    <button onclick="router('shop')" class="absolute top-24 left-6 md:left-20 text-gray-500 hover:text-white mb-8 flex items-center text-sm uppercase font-bold tracking-widest">
                        <i class="fas fa-arrow-left mr-2"></i> Back to Shop
                    </button>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-12 lg:gap-24 w-full mt-10 md:mt-0">
                        <div class="rounded-2xl overflow-hidden h-[400px] md:h-[600px] relative glass">
                            <img src="${product.image}" class="w-full h-full object-cover">
                        </div>
                        
                        <div class="flex flex-col justify-center">
                            <span class="text-neon-green font-bold uppercase tracking-[0.2em] text-sm mb-2">${product.category}</span>
                            <h1 class="text-5xl md:text-7xl font-header font-bold text-white mb-6 leading-none">${product.name}</h1>
                            <p class="text-2xl font-header text-white mb-8">R${product.price} <span class="text-sm text-gray-500 font-sans font-normal ml-2">per unit (Tax Incl.)</span></p>
                            
                            <p class="text-gray-400 leading-relaxed mb-10 border-l-2 border-neon-green pl-6">
                                ${product.desc} <br><br>
                                Sourced from the finest growers in the Western Cape. Lab tested for purity and potency.
                            </p>
                            
                            <div class="flex space-x-4">
                                <button onclick="addToCart(${product.id}, '${product.name}', ${product.price})" class="flex-1 bg-neon-green text-dark-950 py-4 font-header font-bold text-lg rounded hover:bg-white transition uppercase tracking-widest">
                                    Add To Stash
                                </button>
                                <button class="px-6 py-4 border border-white/20 rounded hover:bg-white/10 transition text-white">
                                    <i class="far fa-heart"></i>
                                </button>
                            </div>
                            
                            <div class="mt-8 flex items-center space-x-8 text-sm text-gray-500">
                                <span class="flex items-center"><i class="fas fa-check text-neon-green mr-2"></i> In Stock</span>
                                <span class="flex items-center"><i class="fas fa-truck text-neon-green mr-2"></i> 2-Day Delivery</span>
                            </div>
                        </div>
                    </div>
                </div>
                `;
            }
        };

        // --- CORE FUNCTIONS ---

        function router(viewName, param = null) {
            const app = document.getElementById('app');
            const viewFn = views[viewName] || views.home;
            
            // Render View
            app.innerHTML = viewFn(param);
            
            // Scroll to top
            window.scrollTo(0, 0);
            
            // Handle offers anchor specifically
            if(param === 'offers' && viewName === 'home') {
                setTimeout(() => {
                    const el = document.getElementById('offers');
                    if(el) el.scrollIntoView({behavior: 'smooth'});
                }, 100);
            }
        }

        // --- CART LOGIC ---
        let cart = [];

        function toggleCart() {
            const sidebar = document.getElementById('cart-sidebar');
            const backdrop = document.getElementById('cart-backdrop');
            
            if (sidebar.classList.contains('translate-x-full')) {
                sidebar.classList.remove('translate-x-full');
                backdrop.classList.remove('hidden');
            } else {
                sidebar.classList.add('translate-x-full');
                backdrop.classList.add('hidden');
            }
        }

        function addToCart(id, name, price) {
            cart.push({id, name, price});
            updateCartUI();
            toggleCart(); // Open cart to confirm add
        }

        function updateCartUI() {
            const cartContainer = document.getElementById('cart-items');
            const countBadge = document.getElementById('cart-count');
            
            // Update Count
            if(cart.length > 0) {
                countBadge.innerText = cart.length;
                countBadge.classList.remove('opacity-0');
            }

            // Update List
            if (cart.length === 0) {
                cartContainer.innerHTML = `
                    <i class="fas fa-leaf text-4xl mb-4 opacity-20"></i>
                    <p>Your stash is empty.</p>
                    <button onclick="toggleCart(); router('shop')" class="mt-4 text-neon-green text-sm font-bold border-b border-neon-green pb-1">START BROWSING</button>
                `;
            } else {
                cartContainer.innerHTML = `<ul class="w-full space-y-4 overflow-y-auto max-h-[60vh]">
                    ${cart.map((item, index) => `
                        <li class="flex justify-between items-center border-b border-white/5 pb-2 animate-pulse-once">
                            <div>
                                <h5 class="text-white font-bold">${item.name}</h5>
                                <p class="text-neon-green text-xs">R${item.price}</p>
                            </div>
                            <button onclick="removeFromCart(${index})" class="text-gray-600 hover:text-red-500"><i class="fas fa-trash"></i></button>
                        </li>
                    `).join('')}
                </ul>`;
            }
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartUI();
        }

        // --- QUIZ LOGIC ---
        let selectedOffer = null;

        function selectQuizOption(quizType) {
            // Find matching offer
            selectedOffer = offers.find(o => o.quiz === quizType);
            if (!selectedOffer) return;

            // Hide quiz, show result
            document.getElementById('offer-quiz').classList.add('hidden');
            document.getElementById('offer-result').classList.remove('hidden');
            document.getElementById('offer-result').classList.add('fade-in');

            // Populate result card
            document.getElementById('result-tier').textContent = selectedOffer.tier + ': ' + selectedOffer.persona;
            document.getElementById('result-name').textContent = selectedOffer.name;
            document.getElementById('result-tagline').textContent = selectedOffer.tagline;
            document.getElementById('result-value').textContent = 'R' + selectedOffer.value.toLocaleString() + ' Value';
            document.getElementById('result-price').textContent = 'R' + selectedOffer.price.toLocaleString();
            document.getElementById('result-cta').textContent = selectedOffer.cta;

            // Populate items
            const itemsContainer = document.getElementById('result-items');
            itemsContainer.innerHTML = selectedOffer.items.map(item =>
                `<li class="flex items-start gap-3">
                    <i class="fas fa-check text-neon-green mt-1"></i>
                    <span>${item}</span>
                </li>`
            ).join('');

            // Scroll to result
            setTimeout(() => {
                document.getElementById('offer-result').scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        }

        function resetQuiz() {
            selectedOffer = null;
            document.getElementById('offer-result').classList.add('hidden');
            document.getElementById('all-offers').classList.add('hidden');
            document.getElementById('offer-quiz').classList.remove('hidden');
            document.getElementById('offer-quiz').classList.add('fade-in');
        }

        function addOfferToCart() {
            if (selectedOffer) {
                addToCart(900 + selectedOffer.id, selectedOffer.name, selectedOffer.price);
            }
        }

        function showAllOffers() {
            const container = document.getElementById('all-offers');
            const grid = document.getElementById('all-offers-grid');

            // Generate all offer cards
            grid.innerHTML = offers.map(offer => `
                <div class="glass p-6 rounded-xl border-t-2 ${offer.featured ? 'border-neon-green bg-white/5' : 'border-gray-700 hover:border-neon-green'} transition-all duration-300 ${offer.featured ? 'ring-1 ring-neon-green/20' : ''}">
                    ${offer.featured ? '<div class="text-neon-green text-xs font-bold uppercase tracking-widest mb-2">Most Popular</div>' : ''}
                    <p class="text-gray-500 text-xs uppercase tracking-widest mb-1">${offer.tier}</p>
                    <h4 class="font-header text-xl text-white mb-2">${offer.name}</h4>
                    <p class="text-gray-500 text-sm mb-4">${offer.tagline}</p>
                    <ul class="space-y-2 mb-6 text-sm text-gray-400">
                        ${offer.items.map(item => `<li class="flex items-start gap-2"><i class="fas fa-check text-neon-green text-xs mt-1"></i> ${item}</li>`).join('')}
                    </ul>
                    <div class="flex items-end justify-between">
                        <div>
                            <p class="text-gray-600 text-xs line-through">R${offer.value.toLocaleString()}</p>
                            <p class="text-2xl font-header font-bold ${offer.featured ? 'text-neon-green' : 'text-white'}">R${offer.price.toLocaleString()}</p>
                        </div>
                        <button onclick="addToCart(${900 + offer.id}, '${offer.name}', ${offer.price})" class="${offer.featured ? 'bg-neon-green text-dark-950' : 'bg-dark-700 text-white hover:bg-neon-green hover:text-dark-950'} px-4 py-2 text-xs font-bold uppercase tracking-widest rounded transition">
                            Add
                        </button>
                    </div>
                </div>
            `).join('');

            container.classList.remove('hidden');
            container.classList.add('fade-in');

            setTimeout(() => {
                container.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        // --- INIT ---
        document.addEventListener('DOMContentLoaded', () => {
            router('home');
        });

    </script>
</body>
</html>